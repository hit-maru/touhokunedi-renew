---
// src/pages/manufacture.astro
import Layout from '../layouts/Layout.astro';
import Process from '../components/manufacture/Process.astro';
import Capability from '../components/manufacture/Capability.astro';
import Equipment from '../components/manufacture/Equipment.astro';
import Labo from '../components/manufacture/Labo.astro';
---

<Layout title="è£½é€ äº‹æ¥­ | æ±åŒ—ãƒãƒ‚è£½é€ æ ªå¼ä¼šç¤¾">

  {/* ãƒ’ãƒ¼ãƒ­ãƒ¼ã‚¨ãƒªã‚¢ï¼šä¼æ¥­æƒ…å ±ã‚’åŸºæº–ã«æ§‹é€ ã¨ã‚¯ãƒ©ã‚¹ã‚’çµ±ä¸€ */}
  <div class="bg-gray-100 pt-[90px] pb-8 border-b border-gray-200">
    <div class="container mx-auto px-6">
      <h1 class="text-4xl md:text-5xl font-mincho font-bold text-[#008B9B] mb-4">è£½é€ äº‹æ¥­</h1>
      <p class="text-gray-500 font-serif tracking-wider uppercase">MANUFACTURING & QUALITY</p>
    </div>
  </div>

  {/* ã‚¹ãƒ†ã‚£ãƒƒã‚­ãƒ¼ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ */}
  <div class="sticky top-20 bg-white/95 backdrop-blur-md z-40 border-b border-gray-100 shadow-sm">
    <div class="container mx-auto px-6 py-3">
      
      {/* ğŸ“± ã‚¹ãƒãƒ›ç”¨ï¼šã‚»ãƒ¬ã‚¯ãƒˆãƒœãƒƒã‚¯ã‚¹å‹ (md:hidden) */}
      <div class="md:hidden relative">
        <select 
          onchange="window.location.hash = this.value"
          class="w-full bg-white border border-[#008B9B]/30 text-[#008B9B] text-sm font-bold rounded-sm px-4 py-3 appearance-none focus:outline-none focus:ring-2 focus:ring-[#008B9B] font-mb101"
        >
          <option value="#">ãƒ¡ãƒ‹ãƒ¥ãƒ¼ï¼šã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’é¸æŠ</option>
          <option value="#process">ä¸€è²«è£½é€ ä½“åˆ¶</option>
          <option value="#capability">è£½å“ç´¹ä»‹</option>
          <option value="#equipment">ä¸»è¦è¨­å‚™</option>
          <option value="#labo">ã­ã¢ãƒ©ãƒœ</option>
          <option value="#inquiry">ãŠå•åˆã›</option>
        </select>
        <div class="absolute inset-y-0 right-4 flex items-center pointer-events-none">
          <svg class="w-4 h-4 text-[#008B9B]" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path d="M19 9l-7 7-7-7" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"/>
          </svg>
        </div>
      </div>

      {/* ğŸ’» PCç”¨ï¼šæ¨ªä¸¦ã³ãƒ¡ãƒ‹ãƒ¥ãƒ¼ (hidden md:flex) */}
      <nav class="hidden md:flex flex-row justify-center gap-10 text-[13px] font-bold text-gray-500 font-mb101">
        <a href="#process" class="hover:text-[#008B9B] transition-colors">ä¸€è²«è£½é€ ä½“åˆ¶</a>
        <a href="#capability" class="hover:text-[#008B9B] transition-colors">è£½å“ç´¹ä»‹</a>
        <a href="#equipment" class="hover:text-[#008B9B] transition-colors">ä¸»è¦è¨­å‚™</a>
        <a href="#labo" class="hover:text-[#008B9B] transition-colors">ã­ã¢ãƒ©ãƒœ</a>
        <a href="#inquiry" class="hover:text-[#008B9B] transition-colors">ãŠå•åˆã›</a>
      </nav>

    </div>
  </div>

  {/* ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆå‘¼ã³å‡ºã—ã‚¨ãƒªã‚¢ï¼šæ§‹æˆã‚’ç¶­æŒ */}
  <div class="[&>section]:scroll-mt-[30px] md:[&>section]:scroll-mt-[20px]">
    <Process />
    <Capability />
    <Equipment />
    <Labo />
    
    {/* å•ã„åˆã‚ã›ã‚»ã‚¯ã‚·ãƒ§ãƒ³ */}
    <section id="inquiry" class="pt-12 pb-24 bg-white">
      <div class="container mx-auto px-6 max-w-4xl">
        
        {/* ãŠé›»è©±ã‚¨ãƒªã‚¢ */}
        <div class="bg-[#E0F7FA] p-4 md:p-12 mb-20 border-l-8 border-[#008B9B]">
          <h2 class="text-2xl font-bold text-[#008B9B] mb-4 flex items-center gap-3 font-mb101">
            ğŸ“ <span class="pt-1">ãŠé›»è©±ã§ã®ãŠå•åˆã›</span>
          </h2>
          <p class="font-sans text-[15px] text-gray-700 mb-8 leading-relaxed font-medium">
            ç‰¹æ³¨å“ã€ã‚ªãƒ¼ãƒ€ãƒ¼ãƒ¡ã‚¤ãƒ‰è£½å“ãªã©ã€å›³é¢ã‚’è¦‹ãªãŒã‚‰ã®ã”ç›¸è«‡ã¯ãŠé›»è©±ãŒã‚¹ãƒ ãƒ¼ã‚ºã§ã™ã€‚è£½é€ æ‹…å½“ãŒæŠ€è¡“çš„ãªã”è³ªå•ã«ãŠç­”ãˆã—ã¾ã™ã€‚
          </p>
          <div class="flex flex-col md:flex-row gap-8 items-start md:items-center">
            <div>
              <p class="text-[11px] font-bold text-gray-500 mb-1 uppercase tracking-widest font-mb101">Manufacturing</p>
              <a href="tel:0246564571" class="text-3xl md:text-4xl font-serif font-bold text-gray-900 hover:text-[#008B9B] transition-colors">
                0246-56-4571
              </a>
              <p class="font-sans text-[12px] text-gray-500 mt-2 font-medium">å—ä»˜æ™‚é–“ï¼š8:00ã€œ17:00ï¼ˆåœŸæ—¥ç¥é™¤ãï¼‰</p>
            </div>
          </div>
        </div>

        {/* ãƒ¡ãƒ¼ãƒ«ãƒ•ã‚©ãƒ¼ãƒ  */}
        <h2 class="text-[#008B9B] font-mb101 text-3xl font-bold mb-8 ttracking-tighter">ãƒ¡ãƒ¼ãƒ«ãƒ•ã‚©ãƒ¼ãƒ </h2>
        <p class="font-sans text-[15px] text-gray-600 mb-12 leading-relaxed font-medium">
          ç‰¹æ³¨å“ã®è£½é€ ã€æŠ€è¡“ç›¸è«‡ã€å›³é¢ã«é–¢ã™ã‚‹ã”è³ªå•ãªã©ã€ãŠæ°—è»½ã«ãŠå•åˆã›ãã ã•ã„ã€‚é€šå¸¸ã€3å–¶æ¥­æ—¥ä»¥å†…ã«è£½é€ æ‹…å½“è€…ã‚ˆã‚Šã”é€£çµ¡ã„ãŸã—ã¾ã™ã€‚
        </p>

        <form action="https://formspree.io/f/mlggrlpq" method="POST" class="space-y-8">
          <div>
            <label for="company" class="block font-sans text-[14px] font-bold text-gray-700 mb-2">
              è²´ç¤¾å <span class="text-[#E64A19] text-[10px] ml-1">å¿…é ˆ</span>
            </label>
            <input type="text" id="company" name="company" placeholder="ä¾‹ï¼‰æ±åŒ—ãƒãƒ‚è£½é€ æ ªå¼ä¼šç¤¾" class="w-full bg-gray-50 border border-gray-300 p-4 font-sans text-[14px] focus:outline-none focus:border-[#008B9B] focus:bg-white transition-colors" required />
          </div>

          <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
            <div>
              <label for="name" class="block font-sans text-[14px] font-bold text-gray-700 mb-2">
                ãŠåå‰ <span class="text-[#E64A19] text-[10px] ml-1">å¿…é ˆ</span>
              </label>
              <input type="text" id="name" name="name" placeholder="ä¾‹ï¼‰æ±åŒ— å¤ªéƒ" class="w-full bg-gray-50 border border-gray-300 p-4 font-sans text-[14px] focus:outline-none focus:border-[#008B9B] focus:bg-white transition-colors" required />
            </div>
            <div>
              <label for="email" class="block font-sans text-[14px] font-bold text-gray-700 mb-2">
                ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ <span class="text-[#E64A19] text-[10px] ml-1">å¿…é ˆ</span>
              </label>
              <input type="email" id="email" name="email" placeholder="ä¾‹ï¼‰info@touhokunedi.com" class="w-full bg-gray-50 border border-gray-300 p-4 font-sans text-[14px] focus:outline-none focus:border-[#008B9B] focus:bg-white transition-colors" required />
            </div>
          </div>

          <div>
            <label for="message" class="block font-sans text-[14px] font-bold text-gray-700 mb-2">
              ãŠå•åˆã›å†…å®¹ <span class="text-[#E64A19] text-[10px] ml-1">å¿…é ˆ</span>
            </label>
            <textarea id="message" name="message" rows="6" placeholder="è£½å“ä»•æ§˜ã€å›³é¢ã€æŠ€è¡“çš„ãªã”è³ªå•ãªã©ã‚’ã”è¨˜å…¥ãã ã•ã„" class="w-full bg-gray-50 border border-gray-300 p-4 font-sans text-[14px] focus:outline-none focus:border-[#008B9B] focus:bg-white transition-colors" required></textarea>
          </div>

          <div class="text-center pt-8">
  <button 
    type="submit" 
    class="bg-[#008B9B] text-white font-bold w-full md:w-auto md:px-24 py-4 font-mb101 text-[16px] hover:bg-[#006064] transition-all shadow-lg hover:shadow-none translate-y-0 hover:translate-y-1"
  >
    å†…å®¹ã‚’ç¢ºèªã—ã¦é€ä¿¡ã™ã‚‹
  </button>
</div>
        </form>
      </div>
    </section>
  </div>

  <div id="lightbox-overlay" class="fixed inset-0 bg-black/95 z-[100] hidden flex items-center justify-center overflow-hidden">
    <button id="lightbox-close" class="absolute top-6 right-6 w-12 h-12 bg-white text-gray-900 rounded-full flex items-center justify-center text-3xl font-bold z-[110] shadow-lg hover:bg-gray-200 transition-colors" aria-label="é–‰ã˜ã‚‹">
      &times;
    </button>
    
    <div id="lightbox-container" class="w-full h-full flex items-center justify-center">
      <img id="lightbox-img" src="" alt="æ‹¡å¤§ç”»åƒ" class="select-none transition-all duration-300" />
    </div>
  </div>

  <style is:global>
    /* 90åº¦å›è»¢ãƒ¢ãƒ¼ãƒ‰ */
    .mode-rotate { max-width: none !important; }
    @media (max-width: 768px) {
      .mode-rotate { transform: rotate(90deg); width: 95vh; }
    }
    /* ãƒ‰ãƒ©ãƒƒã‚°ç§»å‹•ãƒ¢ãƒ¼ãƒ‰ */
    .mode-move { cursor: grab; transform: scale(1.5); will-change: transform; }
    .mode-move:active { cursor: grabbing; }
  </style>

  <script>
    const overlay = document.getElementById('lightbox-overlay');
    const container = document.getElementById('lightbox-container');
    const lightboxImg = document.getElementById('lightbox-img') as HTMLImageElement;
    const closeBtn = document.getElementById('lightbox-close');

    let isDragging = false;
    let startX = 0, startY = 0;
    let translateX = 0, translateY = 0;
    let currentMode = '';

    const allImages = document.querySelectorAll('.js-rotate, .js-move');

    allImages.forEach(img => {
      img.addEventListener('click', () => {
        const target = img as HTMLImageElement;
        if (!lightboxImg || !overlay) return;

        lightboxImg.src = target.src;
        overlay.classList.remove('hidden');
        document.body.style.overflow = 'hidden';

        translateX = 0; translateY = 0;
        lightboxImg.classList.remove('mode-rotate', 'mode-move');

        if (target.classList.contains('js-rotate')) {
          currentMode = 'rotate';
          lightboxImg.classList.add('mode-rotate');
          lightboxImg.style.transform = ''; 
        } else {
          currentMode = 'move';
          lightboxImg.classList.add('mode-move');
          updateMoveTransform();
        }
      });
    });

    closeBtn?.addEventListener('click', () => {
      overlay?.classList.add('hidden');
      document.body.style.overflow = '';
    });

    const startDrag = (e: any) => {
      if (currentMode !== 'move') return;
      isDragging = true;
      const clientX = e.touches ? e.touches[0].clientX : e.clientX;
      const clientY = e.touches ? e.touches[0].clientY : e.clientY;
      startX = clientX - translateX;
      startY = clientY - translateY;
    };

    const moveDrag = (e: any) => {
      if (!isDragging || currentMode !== 'move') return;
      if (e.cancelable) e.preventDefault();
      const clientX = e.touches ? e.touches[0].clientX : e.clientX;
      const clientY = e.touches ? e.touches[0].clientY : e.clientY;
      translateX = clientX - startX;
      translateY = clientY - startY;
      updateMoveTransform();
    };

    const stopDrag = () => { isDragging = false; };

    function updateMoveTransform() {
      if (lightboxImg) {
        lightboxImg.style.transform = `translate(${translateX}px, ${translateY}px) scale(1.5)`;
      }
    }

    container?.addEventListener('mousedown', startDrag);
    window.addEventListener('mousemove', moveDrag);
    window.addEventListener('mouseup', stopDrag);
    container?.addEventListener('touchstart', startDrag, { passive: false });
    window.addEventListener('touchmove', moveDrag, { passive: false });
    window.addEventListener('touchend', stopDrag);
  </script>

</Layout>